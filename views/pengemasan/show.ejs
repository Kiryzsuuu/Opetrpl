<%- include('../partials/page-start', { title }) %>

<div class="d-flex justify-content-between align-items-center mb-4 page-animate">
  <div>
    <h2 class="mb-1"><i class="bi bi-box-seam"></i> Detail Pengemasan</h2>
    <div class="text-secondary small">Jenis Pengemas: <strong><%= pengemasan.jenisPengemas || '-' %></strong></div>
  </div>
  <div class="d-flex gap-2">
    <a href="/pengemasan/<%= pengemasan._id %>/edit" class="btn btn-primary"><i class="bi bi-pencil"></i> Edit</a>
    <a href="/pengemasan" class="btn btn-outline-secondary"><i class="bi bi-arrow-left"></i> Kembali</a>
  </div>
</div>

<%- include('../partials/flash') %>

<div class="row g-3">
  <div class="col-lg-8">
    <div class="card">
      <div class="card-body">
        <dl class="row mb-0">
          <dt class="col-sm-4">Produksi</dt>
          <dd class="col-sm-8">
            <% if (pengemasan.produksi) { %>
              <span class="badge bg-secondary"><%= pengemasan.produksi.kodeProduksi || '-' %></span>
              <span class="ms-2">Batch <%= pengemasan.produksi.batchNumber || '-' %></span>
              <% if (pengemasan.produksi.formulasi) { %>
                <div class="text-secondary small mt-1">Formulasi: <%= pengemasan.produksi.formulasi.nama || '-' %> (<%= pengemasan.produksi.formulasi.kode || '-' %>)</div>
              <% } %>
            <% } else { %>
              -
            <% } %>
          </dd>

          <dt class="col-sm-4">Tanggal Kemas</dt>
          <dd class="col-sm-8"><%= pengemasan.tanggalKemas ? new Date(pengemasan.tanggalKemas).toLocaleDateString('id-ID') : '-' %></dd>

          <dt class="col-sm-4">Jenis Pengemas</dt>
          <dd class="col-sm-8"><%= pengemasan.jenisPengemas || '-' %></dd>

          <dt class="col-sm-4">Ukuran Kemasan</dt>
          <dd class="col-sm-8"><%= pengemasan.ukuranKemasan || '-' %></dd>

          <dt class="col-sm-4">Jumlah Kemasan</dt>
          <dd class="col-sm-8"><%= pengemasan.jumlahKemasan ?? '-' %></dd>

          <dt class="col-sm-4">Berat/Kemasan</dt>
          <dd class="col-sm-8"><%= pengemasan.beratPerKemasan ?? '-' %></dd>

          <dt class="col-sm-4">Nomor Batch</dt>
          <dd class="col-sm-8"><%= pengemasan.nomorBatch || '-' %></dd>

          <dt class="col-sm-4">Tanggal Kadaluarsa</dt>
          <dd class="col-sm-8"><%= pengemasan.tanggalKadaluarsa ? new Date(pengemasan.tanggalKadaluarsa).toLocaleDateString('id-ID') : '-' %></dd>

          <dt class="col-sm-4">Label Nutrisi</dt>
          <dd class="col-sm-8"><%= pengemasan.labelNutrisi ? 'Ya' : 'Tidak' %></dd>

          <dt class="col-sm-4">Label Halal</dt>
          <dd class="col-sm-8"><%= pengemasan.labelHalal ? 'Ya' : 'Tidak' %></dd>

          <dt class="col-sm-4">Standar Keamanan</dt>
          <dd class="col-sm-8"><%= pengemasan.standarKeamanan || '-' %></dd>

          <dt class="col-sm-4">Status</dt>
          <dd class="col-sm-8">
            <span class="badge <%= pengemasan.status === 'Selesai' ? 'bg-success' : (pengemasan.status === 'Gagal' ? 'bg-danger' : 'bg-secondary') %>"><%= pengemasan.status || '-' %></span>
          </dd>

          <dt class="col-sm-4">Catatan</dt>
          <dd class="col-sm-8"><%= pengemasan.catatan || '-' %></dd>
        </dl>
      </div>
    </div>

    <div class="card mt-3">
      <div class="card-header"><i class="bi bi-shield-check"></i> Sertifikasi Keamanan</div>
      <div class="card-body">
        <pre class="mb-0"><%= JSON.stringify(pengemasan.sertifikasiKeamanan || [], null, 2) %></pre>
      </div>
    </div>

    <div class="card mt-3">
      <div class="card-header"><i class="bi bi-clock-history"></i> Audit Trail</div>
      <div class="card-body">
        <pre class="mb-0"><%= JSON.stringify(pengemasan.auditTrail || [], null, 2) %></pre>
      </div>
    </div>
  </div>

  <div class="col-lg-4">
    <div class="card">
      <div class="card-body">
        <h5 class="mb-3">Aksi</h5>
        <form action="/pengemasan/<%= pengemasan._id %>?_method=DELETE" method="POST" data-confirm="Hapus data pengemasan ini?" data-confirm-btn-class="btn-danger" data-confirm-ok-text="Hapus">
          <button class="btn btn-danger w-100" type="submit"><i class="bi bi-trash"></i> Hapus</button>
        </form>
      </div>
    </div>
  </div>
</div>

<%- include('../partials/page-end') %>
